<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:c="http://java.sun.com/jstl/core">
<head>
    <title>Password Expiring Page</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>

<body>
    <ui:composition>
		<h:graphicImage value="/images/tolven-login-backimage.png" rendered="true" />
		<div style="clear:both"/>
		<hr/>
		
		<h2>Password Expiring Page</h2>

		<h:panelGrid columns="2">
			<h:outputText value="Expiration: " />
			<h:inputText id="expiration" value="#{changepasswd.formattedExpiration}" size="50" readonly="true" />
		</h:panelGrid>
	
		<div style="clear:both"/>
		<hr/>
		
		 <h:form id="changepasswdForm">
			<h:panelGrid columns="2">
				<h:outputText value="Realm" />
				<h:inputText id="realm" value="#{changepasswd.realm}" size="50" readonly="true" />
				<h:outputText value="Email Address/User ID" />
				<h:inputText id="uid" value="#{changepasswd.uid}" size="50" readonly="true" />
				<h:outputText value="Old Password" />
				<h:panelGroup>
					<h:inputSecret id="oldUserPassword" value="#{changepasswd.oldUserPassword}" size="50" required="true" />
					<h:message for="oldUserPassword" errorClass="errorMsg" infoClass="infoMsg" warnClass="warnMsg" fatalClass="fatalMsg" />
				</h:panelGroup>
				<h:outputText value="New Password" />
				<h:panelGroup>
					<h:inputSecret id="newUserPassword" value="#{changepasswd.newUserPassword}" size="50" required="true" />
					<h:message for="newUserPassword" errorClass="errorMsg" infoClass="infoMsg" warnClass="warnMsg" fatalClass="fatalMsg" />
				</h:panelGroup>
				<h:outputText value="Repeat New Password" />
				<h:panelGroup>
					<h:inputSecret id="newUserPassword2" value="#{changepasswd.newUserPassword2}" size="50" required="true" />
					<h:message for="newUserPassword2" errorClass="errorMsg" infoClass="infoMsg" warnClass="warnMsg" fatalClass="fatalMsg" />
				</h:panelGroup>
			</h:panelGrid>
			<h:panelGrid rendered="#{changepasswd.activeSecurityQuestion != null}">
                <h:panelGroup rendered="#{changepasswd.activeSecurityQuestion != null}">
					<h:outputText value="You have a previous security question backing up your password, which must be reset or a new one selected and answered." />
					<br />
					<h:outputText value="To deactivate your security question, select the checkbox." />
                </h:panelGroup>
               </h:panelGrid>
			<h:panelGrid columns="2" rendered="#{changepasswd.activeSecurityQuestion != null}">
				<h:outputText value="Current Security Question" />
				<h:panelGroup>
					<h:selectOneMenu id="securityQuestion" value="#{changepasswd.securityQuestion}">
						<f:selectItems value="#{changepasswd.loginSecurityQuestions}" />
					</h:selectOneMenu>
					<h:message for="securityQuestion" errorClass="errorMsg" infoClass="infoMsg" warnClass="warnMsg" fatalClass="fatalMsg" />
				</h:panelGroup>
				<h:outputText value="Answer" />
				<h:panelGroup>
					<h:inputSecret id="securityQuestionAnswer" value="#{changepasswd.securityQuestionAnswer}" size="75" />
					<h:message for="securityQuestionAnswer" errorClass="errorMsg" infoClass="infoMsg" warnClass="warnMsg" fatalClass="fatalMsg" />
				</h:panelGroup>
				<h:outputText value="Confirm Answer" />
				<h:panelGroup>
					<h:inputSecret id="confirmSecurityQuestionAnswer" value="#{changepasswd.confirmSecurityQuestionAnswer}" size="75" />
					<h:message for="confirmSecurityQuestionAnswer" errorClass="errorMsg" infoClass="infoMsg" warnClass="warnMsg" fatalClass="fatalMsg" />
				</h:panelGroup>
				<h:outputText value="Remove Security Question" />
				<h:selectBooleanCheckbox value="#{changepasswd.removeSecurityQuestion}"/>
			</h:panelGrid>
			<h:commandButton action="#{changepasswd.mustChangeLoginPassword}" value="Submit"/>
		</h:form>
		<h:message for="changepasswdForm" errorClass="errorMsg" infoClass="infoMsg" warnClass="warnMsg" fatalClass="fatalMsg" />
		
		<div style="clear:both"/>
		<hr/>
		<h:form id="laterForm">
	    	<h:commandLink id="later" action="#{changepasswd.later}">
				<h:outputText value="Later"/><br/>
	    	</h:commandLink>
	   </h:form>
		
	</ui:composition>
  </body>
</html>
