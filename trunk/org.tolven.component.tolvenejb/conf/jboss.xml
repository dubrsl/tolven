<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE jboss PUBLIC "-//JBoss//DTD JBOSS 5.0//EN" "http://www.jboss.org/j2ee/dtd/jboss_5_0.dtd">
<jboss>
	<!-- security-domain should be readable from jboss-app.xml, but does not work in JBoss-4.2.2.GA -->
	<security-domain>java:/jaas/tolvenLDAP</security-domain>
	<enterprise-beans>
		<session>
			<ejb-name>AccountProcessingProtectionBean</ejb-name>
			<resource-ref>
				<res-ref-name>passwordStore</res-ref-name>
				<jndi-name>java:/passwordStore</jndi-name>
			</resource-ref>
		</session>
		<session>
			<ejb-name>AdminAppQueueBean</ejb-name>
			<resource-ref>
				<res-ref-name>jms/JmsXA</res-ref-name>
				<jndi-name>java:/JmsXA</jndi-name>
			</resource-ref>
			<security-identity>
				<run-as-principal>tolvenAdminApp</run-as-principal>
			</security-identity>
		</session>
		<session>
			<ejb-name>GeneratorQueueBean</ejb-name>
			<resource-ref>
				<res-ref-name>jms/JmsXA</res-ref-name>
				<jndi-name>java:/JmsXA</jndi-name>
			</resource-ref>
			<security-identity>
				<run-as-principal>tolvenGen</run-as-principal>
			</security-identity>
		</session>
		<session>
			<ejb-name>InvitationQueueBean</ejb-name>
			<resource-ref>
				<res-ref-name>jms/JmsXA</res-ref-name>
				<jndi-name>java:/JmsXA</jndi-name>
			</resource-ref>
			<security-identity>
				<run-as-principal>tolvenInvitation</run-as-principal>
			</security-identity>
		</session>
		<session>
			<ejb-name>LDAPBean</ejb-name>
			<resource-ref>
				<res-ref-name>tolven/ldap</res-ref-name>
				<jndi-name>tolven/ldap</jndi-name>
			</resource-ref>
		</session>
		<session>
			<ejb-name>RuleQueueBean</ejb-name>
			<resource-ref>
				<res-ref-name>jms/JmsXA</res-ref-name>
				<jndi-name>java:/JmsXA</jndi-name>
			</resource-ref>
			<security-identity>
				<run-as-principal>mdbuser</run-as-principal>
			</security-identity>
		</session>
		<session>
			<ejb-name>TolvenMessageScheduler</ejb-name>
			<security-identity>
				<run-as-principal>mdbuser</run-as-principal>
			</security-identity>
		</session>
		<message-driven>
			<ejb-name>AdminAppMDB</ejb-name>
			<activation-config>
				<activation-config-property>
					<activation-config-property-name>destination</activation-config-property-name>
					<activation-config-property-value>java:/queue/adminApp</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>destinationType</activation-config-property-name>
					<activation-config-property-value>javax.jms.Queue</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>password</activation-config-property-name>
					<activation-config-property-value>tolvenAdminApp</activation-config-property-value>
				</activation-config-property>
				<!-- JBoss specific, but JBoss won't read it from its own jboss.xml for some reason -->
				<activation-config-property>
					<activation-config-property-name>user</activation-config-property-name>
					<activation-config-property-value>tolvenAdminApp</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<!-- Keep thread-count small so we don't clobber user performance -->
					<activation-config-property-name>maxSession</activation-config-property-name>
					<activation-config-property-value>1</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQJNDIName</activation-config-property-name>
					<activation-config-property-value>java:/queue/adminAppDLQ</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQUser</activation-config-property-name>
					<activation-config-property-value>tolvenAdminApp</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQPassword</activation-config-property-name>
					<activation-config-property-value>tolvenAdminApp</activation-config-property-value>
				</activation-config-property>
			</activation-config>
			<destination-jndi-name>java:/queue/adminApp</destination-jndi-name>
			<security-identity>
				<run-as-principal>tolvenAdminApp</run-as-principal>
			</security-identity>
		</message-driven>
		<message-driven>
			<ejb-name>Evaluator</ejb-name>
			<activation-config>
				<activation-config-property>
					<activation-config-property-name>destination</activation-config-property-name>
					<activation-config-property-value>java:/queue/rule</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>destinationType</activation-config-property-name>
					<activation-config-property-value>javax.jms.Queue</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>password</activation-config-property-name>
					<activation-config-property-value>mdbuser</activation-config-property-value>
				</activation-config-property>
				<!-- JBoss specific, but JBoss won't read it from its own jboss.xml for some reason -->
				<activation-config-property>
					<activation-config-property-name>user</activation-config-property-name>
					<activation-config-property-value>mdbuser</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<!-- Keep thread-count small so we don't clobber user performance -->
					<activation-config-property-name>maxSession</activation-config-property-name>
					<activation-config-property-value>2</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQJNDIName</activation-config-property-name>
					<activation-config-property-value>java:/queue/ruleDLQ</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQUser</activation-config-property-name>
					<activation-config-property-value>mdbuser</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQPassword</activation-config-property-name>
					<activation-config-property-value>mdbuser</activation-config-property-value>
				</activation-config-property>
			</activation-config>
			<destination-jndi-name>java:/queue/rule</destination-jndi-name>
			<security-identity>
				<run-as-principal>mdbuser</run-as-principal>
			</security-identity>
		</message-driven>
		<message-driven>
			<ejb-name>GenDriver</ejb-name>
			<activation-config>
				<activation-config-property>
					<activation-config-property-name>destination</activation-config-property-name>
					<activation-config-property-value>java:/queue/generator</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>destinationType</activation-config-property-name>
					<activation-config-property-value>javax.jms.Queue</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>password</activation-config-property-name>
					<activation-config-property-value>tolvenGen</activation-config-property-value>
				</activation-config-property>
				<!-- JBoss specific, but JBoss won't read it from its own jboss.xml for some reason -->
				<activation-config-property>
					<activation-config-property-name>user</activation-config-property-name>
					<activation-config-property-value>tolvenGen</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<!-- We limit this queue so we don't clobber user performance -->
					<activation-config-property-name>maxSession</activation-config-property-name>
					<activation-config-property-value>1</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQJNDIName</activation-config-property-name>
					<activation-config-property-value>java:/queue/generatorDLQ</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQUser</activation-config-property-name>
					<activation-config-property-value>tolvenGen</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQPassword</activation-config-property-name>
					<activation-config-property-value>tolvenGen</activation-config-property-value>
				</activation-config-property>
			</activation-config>
			<destination-jndi-name>java:/queue/generator</destination-jndi-name>
			<security-identity>
				<run-as-principal>tolvenGen</run-as-principal>
			</security-identity>
		</message-driven>
		<message-driven>
			<ejb-name>InvitationSender</ejb-name>
			<activation-config>
				<activation-config-property>
					<activation-config-property-name>destination</activation-config-property-name>
					<activation-config-property-value>java:/queue/invitation</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>destinationType</activation-config-property-name>
					<activation-config-property-value>javax.jms.Queue</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>password</activation-config-property-name>
					<activation-config-property-value>tolvenInvitation</activation-config-property-value>
				</activation-config-property>
				<!-- JBoss specific, but JBoss won't read it from its own jboss.xml for some reason -->
				<activation-config-property>
					<activation-config-property-name>user</activation-config-property-name>
					<activation-config-property-value>tolvenInvitation</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQJNDIName</activation-config-property-name>
					<activation-config-property-value>java:/queue/invitationDLQ</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQUser</activation-config-property-name>
					<activation-config-property-value>tolvenInvitation</activation-config-property-value>
				</activation-config-property>
				<activation-config-property>
					<activation-config-property-name>dLQPassword</activation-config-property-name>
					<activation-config-property-value>tolvenInvitation</activation-config-property-value>
				</activation-config-property>
			</activation-config>
			<destination-jndi-name>java:/queue/invitation</destination-jndi-name>
			<security-identity>
				<run-as-principal>tolvenInvitation</run-as-principal>
			</security-identity>
		</message-driven>
	</enterprise-beans>
	<assembly-descriptor>
		<security-role>
			<role-name>tolvenAdminApp</role-name>
			<principal-name>tolvenAdminApp</principal-name>
		</security-role>
		<security-role>
			<role-name>tolvenAdminAppDLQ</role-name>
			<principal-name>tolvenAdminApp</principal-name>
		</security-role>
		<security-role>
			<role-name>tolvenGen</role-name>
			<principal-name>tolvenGen</principal-name>
		</security-role>
		<security-role>
			<role-name>tolvenGenDLQ</role-name>
			<principal-name>tolvenGen</principal-name>
		</security-role>
		<security-role>
			<role-name>tolvenRule</role-name>
			<principal-name>mdbuser</principal-name>
		</security-role>
		<security-role>
			<role-name>tolvenRuleDLQ</role-name>
			<principal-name>mdbuser</principal-name>
		</security-role>
		<security-role>
			<role-name>tolvenInvitation</role-name>
			<principal-name>tolvenInvitation</principal-name>
		</security-role>
		<security-role>
			<role-name>tolvenInvitationDLQ</role-name>
			<principal-name>tolvenInvitation</principal-name>
		</security-role>
		<security-role>
			<role-name>tolvenSystem</role-name>
			<principal-name>mdbuser</principal-name>
			<principal-name>tolvenAdminApp</principal-name>
			<principal-name>tolvenGen</principal-name>
			<principal-name>tolvenInvitation</principal-name>
		</security-role>
		<message-destination>
			<message-destination-name>RuleQueue</message-destination-name>
			<jndi-name>java:/queue/rule</jndi-name>
		</message-destination>
		<message-destination>
			<message-destination-name>AdminAppQueue</message-destination-name>
			<jndi-name>java:/queue/adminApp</jndi-name>
		</message-destination>
		<message-destination>
			<message-destination-name>GeneratorQueue</message-destination-name>
			<jndi-name>java:/queue/generator</jndi-name>
		</message-destination>
		<message-destination>
			<message-destination-name>InvitationQueue</message-destination-name>
			<jndi-name>java:/queue/invitation</jndi-name>
		</message-destination>
	</assembly-descriptor>
</jboss>