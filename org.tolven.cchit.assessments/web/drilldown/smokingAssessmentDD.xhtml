<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:wiz="http://www.tolven.org/jsf/wizard"
    xmlns:trim="http://www.tolven.org/jsf/trim">
    
<head>
	<title>Smoking Assessment - Drilldown</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
	
<body>
	<ui:composition>
		<wiz:body>
			<table width="100%">
          		<tr>
          			<td width="25%" style="text-align: left;">#{trim.trim.act.effectiveTime.label.value}</td>
          			<td width="25%" style="text-align: left;">
          				<trim:TS id="effectiveDate" value="#{trim.trim.act.effectiveTime.TS}" dateStyle="short" readonly="true" /></td>
          			<td width="25%" style="text-align: left;"></td>
          			<td width="25%" style="text-align: left;"></td>
          				</tr>
          				<tr>
          					<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.observation.value.label.value}</td>
          					<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.observation.value.CE.displayName}</td>
          					<td width="25%" style="text-align: left;">Smoking Status Recode:</td>
          					<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.observation.value.CE.code}</td>
          				</tr>
          				<c:if test="#{trim.trim.act.relationship['smoker'].act.observation.value.CE.displayName!='Never smoker' and trim.trim.act.relationship['smoker'].act.observation.value.CE.displayName!='Smoker, current status unknown' and trim.trim.act.relationship['smoker'].act.observation.value.CE.displayName!='Unknown if ever smoked'}">
	          				<tr>
	          					<td colspan="4">
				          			<table width="100%">
				          				<tr>
				          					<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['duration'].act.effectiveTime.IVLTS.low.label.value}</td>
				          					<td width="75%" style="text-align: left;">
				          						<trim:TSNew id="commenceDate" value="#{trim.trim.act.relationship['smoker'].act.relationship['duration'].act.effectiveTime.IVLTS.low.TS}" dateStyle="short" readonly="true" />
				          					</td>
				          				</tr>
				          				<tr>
				          					<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['duration'].act.effectiveTime.IVLTS.high.label.value}</td>
				          					<td width="75%" style="text-align: left;">
				          						<trim:TSNew id="endDate" value="#{trim.trim.act.relationship['smoker'].act.relationship['duration'].act.effectiveTime.IVLTS.high.TS}" dateStyle="short" readonly="true" />
				          					</td>
				          				</tr>
				          				<tr>
				          					<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['substance'].act.observation.value.label.value}</td>
				          					<td width="75%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['substance'].act.observation.value.CE.displayName}</td>
				          				</tr>
				          				<tr>
				          					<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['quantity'].act.observation.values[0].label.value}</td>
				          					<td width="75%" style="text-align: left;">
											<c:if test="#{trim.trim.act.relationship['smoker'].act.relationship['substance'].act.observation.value.CE.displayName=='Cigarette smoking tobacco'}">
												<h:outputText value="Cigarettes : "/>
												#{trim.trim.act.relationship['smoker'].act.relationship['quantity'].act.observation.values[1].ST.value}
											</c:if>
											<c:if test="#{trim.trim.act.relationship['smoker'].act.relationship['substance'].act.observation.value.CE.displayName!='Cigarette smoking tobacco'}">
												#{trim.trim.act.relationship['smoker'].act.relationship['quantity'].act.observation.values[2].ST.value}
												#{trim.trim.act.relationship['smoker'].act.relationship['quantity'].act.observation.values[0].CE.displayName}
											</c:if>
										</td>
				          				</tr>
				          				<tr>
				          					<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['frequency'].act.observation.value.label.value}</td>
				          					<td width="75%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['frequency'].act.observation.value.CE.displayName}</td>
				          				</tr>
				          				<tr>
				          					<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['smokingProgram'].act.observation.values[0].label.value}</td>
				          					<td width="75%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['smokingProgram'].act.observation.values[0].CE.displayName}</td>
				          				</tr>
				          				<c:if test="#{trim.trim.act.relationship['smoker'].act.relationship['smokingProgram'].act.observation.values[0].CE.displayName == 'Yes'}">
					          				<tr>
					          					<td width="25%" style="text-align: left;">Program</td>
					          					<td width="75%" style="text-align: left;">#{trim.trim.act.relationship['smoker'].act.relationship['smokingProgram'].act.observation.values[1].ST.value}</td>
					          				</tr>
				          				</c:if>
				          			</table>
				          		</td>
			          		</tr>
			          	</c:if>
		          		<tr>
		          			<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['comments'].act.title.ST.value}</td>
		          			<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['comments'].act.text.ST.value}</td>
							<td width="25%" style="text-align: left;"></td>
          					<td width="25%" style="text-align: left;"></td>
		          		</tr>
		          		<tr>
		          			<td width="25%" style="text-align: left;">#{trim.trim.act.relationship['encounterAssociations'].act.observation.value.label.value}</td>
		          			<td width="25%" style="text-align: left;">
						    	#{trim.trim.act.relationship['encounterAssociations'].act.observation.value.CE.displayName}		
		          			</td>
							<td width="25%" style="text-align: left;"></td>
          					<td width="25%" style="text-align: left;"></td>
		          		</tr>
		          	</table>
		          	<c:if test="#{AssessmentHistory.history != null}">
    				<div style="width:100%;height:100%; padding: 5px;">
					<a href="#" onclick="$('historyDisplayTable').toggle();return false;">History</a>
						<table cellspacing="0" cellpadding="0" style="display: none;" id="historyDisplayTable" width="60%">
							<thead>
			    				<tr>
			    					<th>User</th>
			    					<th>Timestamp</th>
			    					<th>Status</th>
			    				</tr>
							</thead>
							<tbody style="width: 100%;">
				    			<c:forEach var="tmp" items="#{AssessmentHistory.history}" varStatus="indx">
				    				<tr>
				    					<td style="width: 33%;">#{tmp['user']}</td>
				    					<td style="width: 33%;">#{tmp['timestamp']}</td>
				    					<td style="width: 33%;">#{tmp['status']}</td>
				    				</tr>
				    			</c:forEach>
							</tbody>
		    			</table>
					</div>
				</c:if>
		</wiz:body>
	</ui:composition>
</body>
	
</html>