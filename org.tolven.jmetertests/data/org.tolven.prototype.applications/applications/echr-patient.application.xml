<application xmlns="urn:tolven-org:menuStructure:1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:schemaLocation="urn:tolven-org:menuStructure:1.0 http://tolven.org/xsd/menuStructure.xsd">
	<extends path="echr">
		<placeholder name="patient" sequence="40" title="Patient" eventInstance="echr:patients:wip" page="/five/patient.xhtml" heading="/five/chartLink.xhtml">
			<field name="lastName" internal="string01">
				<from>#{xpath['patient/name/family/text()']}</from>
				<from>#{xpath['patient/name/text()']}</from>
				<from>#{role.player.name.EN['L'].formattedParts['FAM']}</from>
				<from>#{nuh["pat_m"]}</from>
			</field>
			<field name="firstName" internal="string02" >
				<from>#{xpath['patient/name/given/text()']}</from>
				<from>#{role.player.name.EN['L'].formattedParts['GIV[0]']}</from>
				<from>#{nuh["sex_d"]}</from>
			</field>
			<field name="middleName" internal="string03" >
				<from>#{xpath["patient/name/family[@qualifier='BR']/text()"]}</from>
				<from>#{role.player.name.EN['L'].formattedParts['GIV[1]']}</from>
				<from>#{nuh["race_d"]}</from>
			</field>
			<field name="dob" internal="date01" >
				<from>#{TStoDate(xpath['patient/birthTime/@value'])}</from>
				<from>#{role.player.livingSubject.birthTime.TS.date}</from>
				<from>#{nuh["birth_d"]}</from>
			</field>
			<field name="sex" internal="string04" >
				<from>#{xpath['patient/administrativeGenderCode/@code']}</from>
				<from>#{role.player.livingSubject.administrativeGenderCode.CE.displayName}</from>
				<from>#{nuh["sex_d"]}</from>
			</field>
			<field name="mrn" internal="string05">
				<from>#{role.id.for['MRN'].extension}</from>
				<from>#{nuh["hrn_n"]}</from>
			</field>
			<field name="vip"  internal="_extended">
				<from>#{trim.act.participation['subject'].role.patient.veryImportantPersonCode.value}</from>
				<from>#{nuh["vip_d"]}</from>
			</field>
			<field name="race"  internal="string06">
				<from>#{trim.field['race']}</from>
				<from>#{nuh["race_d"]}</from>
			</field>
			<field name="nationality"  internal="string07">
				<from>#{nuh["nationality_d"]}</from>
			</field>
			<field name="gender"  internal="_extended">
				<from>#{trim.act.participation['subject'].role.player.livingSubject.administrativeGenderCode.value}</from>
			</field>
			<field name="homeAddr1" internal="_extended" type="string">
				<from>#{xpath["addr[@use='H']/streetName/text()"]}</from>
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['AL[0]'].ST.value}</from>
				<from>#{nuh["street1_t"]}</from>
			</field>
			<field name="homeAddr2"  internal="_extended" type="string">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['AL[1]'].ST.value}</from>
				<from>#{nuh["street2_t"]}</from>
			</field>
			<field name="homeCity"  internal="_extended" type="string">
				<from>#{xpath["addr[@use='H']/city"]}</from>
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['CTY'].ST.value}</from>
			</field>
			<field name="homeState"  internal="_extended" type="string">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['STA'].ST.value}</from>
			</field>
			<field name="homeZip"  internal="_extended" type="string">
				<from>#{xpath["addr[@use='H']/postalCode"]}</from>
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['ZIP'].ST.value}</from>
				<from>#{nuh["postal_c"]}</from>
			</field>
			<field name="homeCountry"  internal="_extended" type="string">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['CNT'].ST.value}</from>
			</field>
			<field name="homeTelecom" internal="_extended" type="string">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.telecom.TEL['H'].value}</from>
				<from>#{nuh["res_tel_n"]}</from>
			</field>
			<field name="primaryName" internal="_computed">
				<from>#{patient.primary.lastName}</from>
				<from>#{patient.otherPrimary}</from>
			</field>
			<field name="primary" internal="parent03">
				<from>#{internalId( account, trim.act.participation['subject'].role.participation['subject'].act.participation['primary'].role.id)}</from>
			</field>
			<field name="otherPrimary" internal="_extended">
				<from>#{trim.act.participation['subject'].role.participation['subject'].act.participation['primary'].role.player.name.EN['L'].formatted}</from>
			</field>
			<field name="surgeonName" internal="_computed">
				<from>#{patient.surgeon.lastName}</from>
				<from>#{patient.otherSurgeon}</from>
			</field>
			<field name="surgeon" internal="parent04">
				<from>#{internalId( account, trim.act.participation['subject'].role.participation['subject'].act.participation['surgeon'].role.id)}</from>
			</field>
			<field name="otherSurgeon" internal="_extended">
				<from>#{trim.act.participation['subject'].role.participation['subject'].act.participation['surgeon'].role.player.name.EN['L'].formatted}</from>
			</field>
			<field name="allergyCount" internal="long01">
			</field>
		</placeholder>
	</extends>
	<extends path="echr">
		<placeholder name="newInShare" sequence="50" title="Received Share" page="/wizard/wizard.xhtml" heading="/five/shareLink.xhtml">
			<field name="effectiveTime" internal="date01">
				<from>#{trim.act.effectiveTime.TS.date}</from>
			</field>
			<field name="senderName" internal="string01">
				<from>#{trim.message.sender.accountName}</from>
			</field>
			<field name="senderComment" internal="string02">
				<from>#{trim.message.sender.comment}</from>
			</field>
			<field name="receiverName" internal="string03">
				<from>#{trim.message.receiver.accountName}</from>
			</field>
			<field name="receiverComment" internal="string04">
				<from>#{trim.message.receiver.comment}</from>
			</field>
			<field name="subject" internal="string05">
				<from>#{trim.act.participation['subject'].role.player.name.EN['L'].formatted}</from>
			</field>
			<!-- Also, pull demographics from message -->
			<field name="lastName">
				<from>#{trim.act.participation['subject'].role.player.name.EN['L'].formattedParts['FAM']}</from>
			</field>
			<field name="firstName">
				<from>#{trim.act.participation['subject'].role.player.name.EN['L'].formattedParts['GIV[0]']}</from>
			</field>
			<field name="middleName">
				<from>#{trim.act.participation['subject'].role.player.name.EN['L'].formattedParts['GIV[1]']}</from>
			</field>
			<field name="dob">
				<from>#{trim.act.participation['subject'].role.player.livingSubject.birthTime.TS.date}</from>
			</field>
			<field name="sex">
				<from>#{trim.act.participation['subject'].role.player.livingSubject.administrativeGenderCode.CE.displayName}</from>
			</field>
			<field name="gender">
				<from>#{trim.act.participation['subject'].role.player.livingSubject.administrativeGenderCode.value}</from>
			</field>
			<field name="race"  internal="string06">
				<from>#{trim.field['race']}</from>
				<from>#{nuh["race_d"]}</from>
			</field>
			<field name="nationality"  internal="string07">
				<from>#{nuh["nationality_d"]}</from>
			</field>
			<field name="homeAddr1">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['AL[1]'].ST.value}</from>
			</field>
			<field name="homeAddr2">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['AL[1]'].ST.value}</from>
			</field>
			<field name="homeCity">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['CTY'].ST.value}</from>
			</field>
			<field name="homeState">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['STA'].ST.value}</from>
			</field>
			<field name="homeZip">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['ZIP'].ST.value}</from>
			</field>
			<field name="homeCountry">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.person.addr.AD['H'].part['CNT'].ST.value}</from>
			</field>
			<field name="homeTelecom">
				<from>#{trim.isName['reg/evn/patient.*'].act.participation['subject'].role.player.telecom.TEL['H'].value}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient">
		<menu name="summary" sequence="1" title="Overview" page="/five/bar2.xhtml" >
			<portal name="portal" title="Summary" page="/five/portletView.xhtml" visible="true"/>
			<timeline name="timeline" title="Timeline" page="/five/timelineView.xhtml" visible="true"/>
			<calendar name="calendar" title="Calendar" page="/five/calendarView.xhtml" visible="true"/>
		</menu>
	</extends>
	<!-- Patient problems -->
	<extends path="echr:patient">
		<placeholder name="problem" title="Problem" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/problemLink.xhtml">
			<field name="title" internal="string01" >
				<from>#{act.observation.value.CE.displayName}</from>
				<from>#{act.title.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="effectiveTimeLow" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="effectiveTimeHigh" internal="date02">
				<from>#{act.effectiveTime.IVLTS.high.date}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="author" internal="parent02">
				<from>#{internalId( account, act.participation['author'].role.id)}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="probsum" visible="never">
			<column name="effectiveTime" internal="date01" format="MM/dd/yy">
				<from>#{problem.effectiveTimeLow}</from>
			</column>
			<column name="title" internal="string01">
				<from>#{problem.title}</from>
			</column>			
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="probsum" portalColumn="1" sequence="1" title="Problems" page="/five/problemSummary.xhtml" query="echr:patient:summary:probsum" visible="true" drilldown=":problems">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:problemDocMenu">
				<column name="Problem" internal="string01" instantiate="true" width="40.0"/>
			</action>
		</portlet>  
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="probsum" sequence="1" title="Problems" query="echr:patient:summary:probsum" visible="true" interval="month" style="#99FFCC" drilldown=":problems"/>  
	</extends>
	<extends path="echr:patient">
		<menu name="problems" sequence="2" title="Problems" page="/five/bar2.xhtml" visible="true">
			<list name="current" title="Current" page="/five/list.xhtml" visible="true" drilldown=":problem">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{problem.effectiveTimeLow}</from>
				</column>
				<column name="Problem" internal="string01" reference="true" width="40.0">
					<from>#{problem.title}</from>
				</column>
				<column name="Source" internal="string02" width="25.0">
					<from>#{problem.author.lastName}</from>
					<from>#{problem.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:problemDocMenu">
					<column name="Problem" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
		</menu>
	</extends>
	<!-- Patient Medications -->
	<extends path="echr:patient">
		<placeholder name="medication" title="Medication" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/medicationLink.xhtml">
			<field name="title" internal="string01" >
				<from>#{act.observation.value.CE.displayName}</from>
				<from>#{act.title.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="source" internal="string02" >
			</field>			
			<field name="status" internal="string03" >
			</field>			
			<field name="brand" internal="string04" >
			</field>			
			<field name="dose" internal="_extended" >
			</field>
			<field name="frequency" internal="_extended" >
			</field>
			<field name="dateType" internal="dateType" >
			</field>									
			<field name="effectiveTimeLow" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="effectiveTimeHigh" internal="date02">
				<from>#{act.effectiveTime.IVLTS.high.date}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="author" internal="parent02">
				<from>#{internalId( account, act.participation['author'].role.id)}</from>
			</field>
			<field name="encounter" internal="parent03">
				<from>#{internalId( account, act.relationship['encounter'].act.id)}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="medsum" visible="never">
			<column name="date" internal="date01" format="MM/dd/yy">
				<from>#{medication.effectiveTimeLow}</from>
			</column>
			<column name="title" internal="string01">
				<from>#{medication.title}</from>
			</column>
			<column name="source" internal="string05">
				<from>#{medication.author.lastName}</from>
				<from>#{medication.enteredBy}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="medsum" portalColumn="2" sequence="1" title="Active Medications" page="/five/summaryPortletList.xhtml" query="echr:patient:summary:medsum" visible="true" drilldown=":medications">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:medicationDocMenu">
				<column name="Medication" internal="string01" instantiate="true" width="40.0"/>
			</action>
		</portlet>
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="medsum" sequence="2" title="Active Medications" query="echr:patient:summary:medsum" visible="true" interval="month" style="CCFFFF" drilldown=":medications"/>
	</extends>
	<extends path="echr:patient:summary:calendar">
		<entry name="med" sequence="2" title="Active Medication" query="echr:patient:summary:medsum" visible="true" drilldown=":medications"/>  
	</extends>
	<extends path="echr:patient">
		<menu name="medications" sequence="4" title="Medications" page="/five/bar2.xhtml" visible="true">
			<list name="current" title="Current" page="/five/list.xhtml" visible="true" drilldown=":medication">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="10.0">
					<from>#{medication.effectiveTimeLow}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{medication.dateType}</from>
				</column>				
				<column name="Medication" internal="string01" reference="true" width="25.0">
					<from>#{medication.title} #{medication.brand}</from>
				</column>
				<column name="Dose" internal="string04" width="25.0">
					<from>#{medication.dose}</from>
				</column>
				<column name="Status" internal="string03" width="10.0">
					<from>#{medication.status}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{medication.source}</from>
					<from>#{medication.author.lastName}</from>
					<from>#{medication.enteredBy}</from>
				</column>
				<column name="AuthorPhone" internal="_computed" width="10.0">
					<from>#{medication.author.workTelecom}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:medicationDocMenu">
					<column name="Medication" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
			<list name="canceled" title="Canceled" page="/five/list.xhtml" visible="true" drilldown=":medication">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="10.0">
					<from>#{medication.effectiveTimeLow}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{medication.dateType}</from>
				</column>				
				<column name="Medication" internal="string01" reference="true" width="25.0">
					<from>#{medication.title} #{medication.brand}</from>
				</column>
				<column name="Status" internal="string03" width="10.0">
					<from>#{medication.status}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{medication.source}</from>
					<from>#{medication.author.lastName}</from>
					<from>#{medication.enteredBy}</from>
				</column>
				<column name="AuthorPhone" internal="_computed" width="10.0">
					<from>#{medication.author.workTelecom}</from>
				</column>				
			</list>
		</menu>
	</extends>
	<!-- Patient Allergies -->
	<extends path="echr:patient">
		<placeholder name="allergy" title="Allergy" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/allergyLink.xhtml">
			<field name="title" internal="string01" >
				<from>#{act.observation.value.CE.displayName}</from>
				<from>#{act.text.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="dateType" internal="dateType" >
				<from>#{allergy.dateType}</from>
			</field>												
			<field name="effectiveTime" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="author" internal="parent02">
				<from>#{internalId( account, act.participation['author'].role.id)}</from>
			</field>
			<field name="encounter" internal="parent03">
				<from>#{internalId( account, act.relationship['encounter'].act.id)}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="allergysum" visible="never">
			<column name="date" internal="date01" format="yyyy">
				<from>#{allergy.effectiveTime}</from>
			</column>
			<column name="title" internal="string01">
				<from>#{allergy.title}</from>
			</column>
			<column name="enteredBy" internal="string05">
				<from>#{allergy.enteredBy}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="allergysum" portalColumn="3" sequence="1" title="Allergies" page="/five/summaryPortletList.xhtml" query="echr:patient:summary:allergysum" visible="true" drilldown=":allergies">  
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:allergyDocMenu">
				<column name="Allergy" internal="string01" instantiate="true" width="40.0"/>
			</action>
		</portlet>  
	</extends>
	<extends path="echr:patient">
		<menu name="allergies"  sequence="3" title="Allergies" page="/five/bar2.xhtml" visible="true">
			<list name="current" title="Current" page="/five/list.xhtml" visible="true" drilldown=":allergy">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="11.0">
					<from>#{allergy.effectiveTime}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{allergy.dateType}</from>
				</column>					
				<column name="Allergy" internal="string01" reference="true" width="40.0">
					<from>#{allergy.title}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{allergy.author.lastName}</from>
					<from>#{allergy.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="10.0">
					<from>#{allergy.encounter.effectiveTimeLow}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:allergyDocMenu">
					<column name="Allergy" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
			<list name="canceled" title="Canceled" page="/five/list.xhtml" visible="true" drilldown=":allergy">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="11.0">
					<from>#{allergy.effectiveTime}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{allergy.dateType}</from>
				</column>					
				<column name="Allergy" internal="string01" reference="true" width="40.0">
					<from>#{allergy.title}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{allergy.author.lastName}</from>
					<from>#{allergy.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="10.0">
					<from>#{allergy.encounter.effectiveTimeLow}</from>
				</column>	
			</list>
			<list name="suspended" title="Suspended" page="/five/list.xhtml" visible="true" drilldown=":allergy">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="11.0">
					<from>#{allergy.effectiveTime}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{allergy.dateType}</from>
				</column>					
				<column name="Allergy" internal="string01" reference="true" width="40.0">
					<from>#{allergy.title}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{allergy.author.lastName}</from>
					<from>#{allergy.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="10.0">
					<from>#{allergy.encounter.effectiveTimeLow}</from>
				</column>	
			</list>
			<list name="held" title="Held" page="/five/list.xhtml" visible="true" drilldown=":allergy">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="11.0">
					<from>#{allergy.effectiveTime}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{allergy.dateType}</from>
				</column>					
				<column name="Allergy" internal="string01" reference="true" width="40.0">
					<from>#{allergy.title}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{allergy.author.lastName}</from>
					<from>#{allergy.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="10.0">
					<from>#{allergy.encounter.effectiveTimeLow}</from>
				</column>	
			</list>
			<list name="nullified" title="Nullified" page="/five/list.xhtml" visible="true" drilldown=":allergy">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="11.0">
					<from>#{allergy.effectiveTime}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{allergy.dateType}</from>
				</column>					
				<column name="Allergy" internal="string01" reference="true" width="40.0">
					<from>#{allergy.title}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{allergy.author.lastName}</from>
					<from>#{allergy.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="10.0">
					<from>#{allergy.encounter.effectiveTimeLow}</from>
				</column>	
			</list>
			<list name="obsolete" title="Obsolete" page="/five/list.xhtml" visible="true" drilldown=":allergy">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="11.0">
					<from>#{allergy.effectiveTime}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{allergy.dateType}</from>
				</column>					
				<column name="Allergy" internal="string01" reference="true" width="40.0">
					<from>#{allergy.title}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{allergy.author.lastName}</from>
					<from>#{allergy.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="10.0">
					<from>#{allergy.encounter.effectiveTimeLow}</from>
				</column>	
			</list>
			<list name="completed" title="Completed" page="/five/list.xhtml" visible="true" drilldown=":allergy">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="11.0">
					<from>#{allergy.effectiveTime}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{allergy.dateType}</from>
				</column>					
				<column name="Allergy" internal="string01" reference="true" width="40.0">
					<from>#{allergy.title}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{allergy.author.lastName}</from>
					<from>#{allergy.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="10.0">
					<from>#{allergy.encounter.effectiveTimeLow}</from>
				</column>	
			</list>
			<list name="aborted" title="Aborted" page="/five/list.xhtml" visible="true" drilldown=":allergy">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="11.0">
					<from>#{allergy.effectiveTime}</from>
				</column>
				<column name="DateType" internal="dateType" width="10.0">
					<from>#{allergy.dateType}</from>
				</column>					
				<column name="Allergy" internal="string01" reference="true" width="40.0">
					<from>#{allergy.title}</from>
				</column>
				<column name="Source" internal="string02" width="10.0">
					<from>#{allergy.author.lastName}</from>
					<from>#{allergy.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="10.0">
					<from>#{allergy.encounter.effectiveTimeLow}</from>
				</column>	
			</list>
		</menu>
	</extends>
	<!-- Patient immunizations -->
	<extends path="echr:patient">
        <placeholder name="immunization" eventInstance="echr:patient:wip" heading="/five/medicationLink.xhtml" page="/wizard/wizard.xhtml" title="Immunization">
            <field internal="string01" name="title">
                <from>#{act.title.ST.value}</from>
                <from>#{trim.description}</from>
            </field>
            <field internal="date01" name="effectiveTimeLow">
                <from>#{act.effectiveTime.TS.date}</from>
                <from>#{act.effectiveTime.IVLTS.low.date}</from>
            </field>
            <field internal="date02" name="effectiveTimeHigh">
                <from>#{act.effectiveTime.IVLTS.high.date}</from>
            </field>
            <field internal="parent01" name="patient">
                <from>#{patient}</from>
            </field>
            <field internal="parent02" name="author">
                <from>#{internalId( account, act.participation['author'].role.id)}</from>
            </field>
            <field internal="parent03" name="encounter">
                <from>#{internalId( account, act.relationship['encounter'].act.id)}</from>
            </field>
            <field internal="string05" name="enteredBy">
                <from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
            </field>
        </placeholder>        		
	</extends>
	<extends path="echr:patient">
        <menu visible="true" sequence="5" page="/five/bar2.xhtml" title="Immun/Vaccin" name="immu">        
            <list drilldown=":immunization" visible="true" page="/five/list.xhtml" title="Current" name="current">
                <column width="15.0" format="MMM-dd-yyyy hh:mm" internal="date01" name="Date">
                    <from>#{immunization.effectiveTimeLow}</from>
                </column>
                <column width="40.0" reference="true" internal="string01" name="Immunization">
                    <from>#{immunization.title}</from>
                </column>
                <column width="15.0" internal="string03" name="Status"/>
                <column width="25.0" internal="string02" name="Source">
                    <from>#{immunization.author.lastName}</from>
                    <from>#{immunization.enteredBy}</from>
                </column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:immunizationMenu">
					<column name="Immunization" internal="string01" instantiate="true" width="40.0"/>
				</action>
            </list>
        </menu>
	</extends>
	<!-- Patient lab/radiology requests and results -->
	<extends path="echr:patient">
		<placeholder name="request" title="Test Request" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/resultLink.xhtml">
			<field name="effectiveTime" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="title" internal="string01" >
				<from>#{act.title.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="source" internal="string03">
			</field>
			<field name="status" internal="string04" >
				<from>#{act.title.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
			<field name="type" internal="string06" >
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="resultsum" visible="never">
			<column name="effectiveTime" internal="date01" format="MM/dd/yy">
				<from>#{result.effectiveTime}</from>
			</column>
			<column name="title" internal="string01">
				<from>#{result.title}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="resultsum" portalColumn="1" sequence="2" title="Results" page="/five/resultSummary.xhtml" query="echr:patient:summary:resultsum" visible="true" drilldown=":results">
		</portlet>  
	</extends>
	<extends path="echr:patient">
		<placeholder name="result" title="Result" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/resultLink.xhtml">
			<field name="effectiveTime" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
				<from>#{nuh["exam_d"]}</from>
			</field>
			<field name="title" internal="string01" >
				<from>#{act.title.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="result" internal="string02">
			</field>
			<field name="value" internal="pqValue01">
			</field>
			<field name="units" internal="pqUnits01">
			</field>
			<field name="source" internal="string03">
			</field>
			<field name="status" internal="string04" >
				<from>#{act.title.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="interp" internal="string05">
			</field>
			<field name="comment" internal="_extended">
			</field>
			<field name="type" internal="string06" >
			</field>
			<field name="patientLocation" >
			</field>
			<field name="accountNumber" >
				<from>#{nuh["acct_n"]}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="request" internal="parent02">
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, trim.act.participation['dataEnterer'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient">
		<menu name="results" sequence="6" title="Results" page="/five/bar2.xhtml" visible="true">
			<list name="request" title="Requests" page="/five/list.xhtml" visible="true" drilldown="request">
				<column name="Date" internal="date01" format="MM/dd/yy" width="10.0">
					<from>#{request.effectiveTime}</from>
				</column>
				<column name="Test" internal="string01" reference="true" width="25.0">
					<from>#{request.title}</from>
				</column>
				<column name="Source" internal="string03" width="25.0">
					<from>#{request.source}</from>
				</column>
				<column name="Status" internal="string02" width="15.0" >
					<from>#{request.status}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:resultMenu">
					<column name="Result" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
			<list name="lab" title="Lab" page="/five/list.xhtml" visible="true" drilldown=":result">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{result.effectiveTime}</from>
				</column>
				<column name="Test" internal="string01"  width="15.0">
					<from>#{result.request.title}</from>
				</column>
				<column name="Result" internal="string02" reference="true" width="15.0">
					<from>#{result.title}</from>
				</column>
				<column name="Value" internal="pqValue01" width="6.0" align="right">
					<from>#{result.value}</from>
				</column>
				<column name="Units" internal="pqUnits01" width="6.0">
					<from>#{result.units}</from>
				</column>
				<column name="Source" internal="string03" width="10.0">
					<from>#{result.source}</from>
				</column>
				<column name="Interp" internal="string04" width="25.0">
					<from>#{result.interp}</from>
				</column>
				<action name="graph" title="Graph" page="/five/list.xhtml" visible="true" query="global:observationMenu">
					<menuEventHandler factory="org.tolven.graph.GraphMenuEventHandlerFactory">
						<data name="timeColumn" value="Date"/>
						<data name="valueColumn" value="Value"/>
						<data name="unitsColumn" value="Units"/>
						<data name="datasetColumn" value="Result"/>
						<data name="title" value="Lab Results"/>
						<data name="xAxisLabel" value="Date"/>
						<data name="yAxisLabel" value="Value"/>
					</menuEventHandler>
				</action>
			</list>
			<list name="rad" title="Radiology" page="/five/list.xhtml" visible="true" drilldown=":result">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{result.effectiveTime}</from>
				</column>
				<column name="Test" internal="string01" reference="true" width="15.0">
					<from>#{result.request.title}</from>
					<from>#{result.title}</from>
				</column>
				<column name="Result" internal="string02" width="20.0">
					<from>#{result.result}</from>
				</column>
				<column name="Source" internal="string03" width="25.0">
					<from>#{result.source}</from>
				</column>
				<column name="Interp" internal="string04" width="20.0">
					<from>#{result.interp}</from>
				</column>
			</list>
		</menu>
	</extends>
	<!-- Patient appointments -->
	<extends path="echr:patient">
		<placeholder name="appointment" title="Appointment" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/appointmentLink.xhtml">
			<field name="effectiveTime" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="title" internal="string01" >
				<from>#{act.title.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="notes" internal="string02" >
				<from>#{act.text.ST.value}</from>
			</field>
			<field name="actStatus" internal="string04">
				<from>#{act.statusCode}</from>
			</field>
			<field name="otherAttender" internal="string03">
			</field>
			<field name="otherLocation" internal="string06">
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="attender" internal="parent02">
				<from>#{internalId( account, act.participation['attender'].role.id)}</from>
			</field>
			<field name="location" internal="parent03">
				<from>#{internalId( account, act.participation['location'].role.id)}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="apptsum" visible="never">
			<column name="date" internal="date01" format="MM/dd/yy">
				<from>#{appointment.effectiveTime}</from>
			</column>
			<column name="purpose" internal="string01">
				<from>#{appointment.title} #{appointment.attender.lastName}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="apptsum" portalColumn="2" sequence="2" title="Appointments" page="/five/summaryPortletList.xhtml" query="echr:patient:summary:apptsum" visible="true" drilldown=":appointments">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:appointmentMenu" >
				<column name="Appointment" internal="string01" instantiate="true" width="30.0"/>
			</action>
		</portlet>  
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="apptsum" sequence="10" title="Appointments" query="echr:patient:summary:apptsum" visible="true" interval="month" style="D4FFD4" drilldown=":appointments"/>  
	</extends>
	<extends path="echr:patient:summary:calendar">
		<entry name="appointment" sequence="3"  title="Appointment" query="echr:patient:summary:apptsum" visible="true" drilldown=":appointments">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:appointmentMenu" >
				<column name="Appointment" internal="string01" instantiate="true" width="30.0"/>
			</action>
		</entry>
	</extends>
	<extends path="echr:patient">
		<menu name="appointments" sequence="7" title="Appointments" page="/five/bar2.xhtml" visible="true">
			<list name="future" title="Upcoming" page="/five/list.xhtml" visible="true" drilldown=":appointment">
				<column name="Date" internal="date01" format="MM/dd/yy hh:mm" width="10.0">
					<from>#{appointment.effectiveTime}</from>
				</column>
				<column name="Purpose" internal="string01" reference="true" width="25.0">
					<from>#{appointment.title}</from>
				</column>
				<column name="With" internal="string03" width="20.0">
					<from>#{appointment.attender.lastName}</from>
					<from>#{appointment.otherAttender}</from>
				</column>
				<column name="At" internal="string05" width="20.0">
					<from>#{appointment.location.name}</from>
					<from>#{appointment.otherLocation}</from>
				</column>
				<column name="Source" internal="string02" width="20.0">
					<from>#{appointment.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:appointmentMenu" >
					<column name="Appointment" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
			<list name="past" title="Past" page="/five/list.xhtml" visible="true" drilldown=":appointment">
				<column name="Date" internal="date01" format="MM/dd/yy hh:mm" width="10.0">
					<from>#{appointment.effectiveTime}</from>
				</column>
				<column name="Purpose" internal="string01" reference="true" width="25.0">
					<from>#{appointment.title}</from>
				</column>
				<column name="With" internal="string03" width="20.0">
					<from>#{appointment.attender.lastName}</from>
					<from>#{appointment.otherAttender}</from>
				</column>
				<column name="At" internal="string05" width="20.0">
					<from>#{appointment.location.name}</from>
					<from>#{appointment.otherLocation}</from>
				</column>
				<column name="Source" internal="string02" width="20.0">
					<from>#{appointment.enteredBy}</from>
				</column>
				<column name="Status" internal="string04" width="15.0">
					<from>#{appointment.actStatus}</from>
				</column>
			</list>
		</menu>
	</extends>
	<!-- Staff Encounters with patients -->
	<extends path="echr:assigned">
		<menu name="encounters" sequence="8" title="Encounters" page="/five/bar2.xhtml" visible="true">
			<list name="in" title="Inpatient" page="/five/list.xhtml" visible="true" drilldown="echr:patient:encounter">
				<column name="Admit" internal="date01" width="15.0">
					<from>#{encounter.effectiveTimeLow}</from>
				</column>
				<column name="Discharge" internal="date02" width="15.0">
					<from>#{encounter.effectiveTimeHigh}</from>
				</column>
				<column name="Patient" internal="string01" reference="true" width="20.0">
					<from>#{encounter.patient.lastName}, #{encounter.patient.firstName} - #{encounter.patient.sex} </from>
				</column>
				<column name="Purpose" internal="string03" width="30.0">
					<from>#{encounter.purpose}</from>
				</column>
				<column name="Location" internal="string02" width="20.0">
					<from>#{encounter.location.name}</from>
					<from>#{encounter.otherLocation}</from>					
				</column>
			</list>
		</menu>
	</extends>
	<!-- Staff Appointments with patients -->
	<extends path="echr:assigned">
		<menu name="appointments" sequence="9" title="Appointments" page="/five/bar2.xhtml" visible="true">
			<list name="all" title="All" page="/five/list.xhtml" visible="true" drilldown="echr:patient:appointment">
				<column name="Date" internal="date01" width="10.0">
					<from>#{appointment.effectiveTime}</from>
				</column>
				<column name="Patient" internal="string01" reference="true" width="20.0">
					<from>#{appointment.patient.lastName}, #{appointment.patient.firstName} - #{appointment.patient.sex} </from>
				</column>
				<column name="Purpose" internal="string02" width="30.0">
					<from>#{appointment.title}</from>
				</column>
			</list>
		</menu>
	</extends>
	<!-- Patient Encounters -->
	<extends path="echr:patient">
		<placeholder name="encounter" title="Encounter" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/encounterLink.xhtml">
			<field name="effectiveTimeLow" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
				<from>#{nuh["adm_d"]}</from>
			</field>
			<field name="effectiveTimeHigh" internal="date02">
				<from>#{act.effectiveTime.IVLTS.high.date}</from>
				<from>#{nuh["disch_d"]}</from>
			</field>
			<field name="purpose" internal="string01" >
				<from>#{act.title.ST.value}</from>
				<from>#{nuh["adm_med_sv_m"]}</from>
			</field>
			<field name="account" internal="string02" >
				<from>#{nuh["acct_n"]}</from>
			</field>
			<field name="status" internal="actStatus">
				<from>#{act.statusCode}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="admitter" internal="parent02">
				<from>#{internalId( account, act.participation['admitter'].role.id)}</from>
			</field>
			<field name="otherAdmitter">
				<from>#{act.participation['admitter'].role.player.name.EN['L'].formatted}</from>
			</field>
			<field name="location" internal="parent03">
				<from>#{internalId( account, act.participation['location'].role.id)}</from>
			</field>
			<field name="otherLocation" >
				<from>#{act.participation['location'].role.player.name.EN['L'].formatted}</from>
				<from>#{nuh["adm_med_sv_m"]}</from>
			</field>			
			<field name="attender" internal="parent04">
				<from>#{internalId( account, act.participation['attender'].role.id)}</from>
			</field>
			<field name="otherAttender">
				<from>#{act.participation['attender'].role.player.name.EN['L'].formatted}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="encsum" visible="never">
			<column name="Date" internal="date01">
				<from>#{encounter.effectiveTimeLow}</from>
			</column>
			<column name="purpose" internal="string01">
				<from>#{encounter.purpose}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="encsum" portalColumn="2" sequence="4" title="Encounters" page="/five/encounterSummary.xhtml" query="echr:patient:summary:encsum" visible="true" drilldown=":encounters">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:encounterMenu" >
				<column name="Encounter" internal="string01" instantiate="true" width="40.0"/>
			</action>
		</portlet>
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="encsum" sequence="4" title="Encounters" query="echr:patient:summary:encsum" visible="true" interval="month" style="FFFFAD" drilldown=":encounters"/>  
	</extends>
	<extends path="echr:patient:summary:calendar">
		<entry name="encounter" sequence="1" title="Encounter" query="echr:patient:summary:encsum" visible="true" drilldown=":encounters"/>  
	</extends>
	<extends path="echr:patient">
		<menu name="encounters" sequence="8" title="Encounters" page="/five/bar2.xhtml" visible="true">
			<list name="active" title="Active" page="/five/list.xhtml" visible="true" drilldown=":encounter">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{encounter.effectiveTimeLow}</from>
				</column>
				<column name="To" internal="date02" format="MMM-dd-yyyy hh:mm" width="10.0" visible="false">
					<from>#{encounter.effectiveTimeHigh}</from>
				</column>
				<column name="Purpose" internal="string01" reference="true" width="20.0">
					<from>#{encounter.purpose}</from>
				</column>
				<column name="Status" internal="string03" width="10.0" visible="false">
					<from>#{encounter.actStatus}</from>
				</column>
				<column name="Admitting" internal="_computed" width="20.0">
					<from>#{encounter.otherAttender}</from>
					<from>#{encounter.admitter.lastName} (#{encounter.admitter.workTelecom})</from>
				</column>
				<column name="Attending" internal="_computed" width="20.0">
					<from>#{encounter.otherAttender}</from>
					<from>#{encounter.attender.lastName} (#{encounter.attender.workTelecom})</from>
				</column>
				<column name="Location" internal="string02" width="20.0">
					<from>#{encounter.location.name}</from>
					<from>#{encounter.otherLocation}</from>					
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:encounterMenu" >
					<column name="Encounter" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
			<list name="inactive" title="Inactive" page="/five/list.xhtml" visible="true" drilldown=":encounter">
				<column name="From" internal="date01" format="MMM-dd-yyyy" width="10.0">
					<from>#{encounter.effectiveTimeLow}</from>
				</column>
				<column name="To" internal="date02" format="MMM-dd-yyyy" width="10.0">
					<from>#{encounter.effectiveTimeHigh}</from>
				</column>
				<column name="Purpose" internal="string01" reference="true" width="20.0">
					<from>#{encounter.purpose}</from>
				</column>
				<column name="Status" internal="string03" width="10.0">
					<from>#{encounter.actStatus}</from>
				</column>
				<column name="Admitting" internal="_computed" width="20.0">
					<from>#{encounter.otherAttender}</from>
					<from>#{encounter.admitter.lastName} (#{encounter.admitter.workTelecom})</from>
				</column>
				<column name="Attending" internal="_computed" width="20.0">
					<from>#{encounter.otherAttender}</from>
					<from>#{encounter.attender.lastName} (#{encounter.attender.workTelecom})</from>
				</column>
			</list>
		</menu>
	</extends>
	<!-- Encounters for the account -->
	<extends path="echr:admin">
		<menu name="encounters" title="Encounters" page="/five/bar2.xhtml" visible="true" >
			<list name="all" title="All" page="/five/list.xhtml" visible="true" drilldown="echr:patient:encounter">
				<column name="From" internal="date01" format="MMM-dd-yyyy hh:mm" width="10.0">
					<from>#{encounter.effectiveTimeLow}</from>
				</column>
				<column name="To" internal="date02" format="MMM-dd-yyyy hh:mm" width="10.0">
					<from>#{encounter.effectiveTimeHigh}</from>
				</column>
				<column name="Patient" internal="parent02"  visible="false">
					<from>#{encounter.patient}</from>
				</column>
				<column name="PatientName" width="20.0">
					<from>#{encounter.patient.lastName}, #{encounter.patient.firstName}</from>
				</column>
				<column name="Purpose" internal="string01" reference="true" width="20.0">
					<from>#{encounter.purpose}</from>
				</column>
				<column name="Status" internal="string03" width="10.0">
					<from>#{encounter.actStatus}</from>
				</column>
				<column name="Attending" internal="string06" width="20.0">
					<from>#{encounter.attender.lastName}</from>
					<from>#{encounter.otherAttender}</from>
				</column>
				<column name="Admitting" internal="string02" width="20.0">
					<from>#{encounter.admitter.lastName}</from>
					<from>#{encounter.otherAdmitter}</from>
				</column>
			</list>
		</menu>
	</extends>
	<!-- Patient Diagnosis -->
	<extends path="echr:patient">
		<placeholder name="diagnosis" title="Diagnosis" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/dxLink.xhtml">
			<field name="title" internal="string01" >
				<from>#{act.observation.value.CE.displayName}</from>
				<from>#{act.title.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="code" internal="string02" >
				<from>#{act.observation.value.CE.code}</from>
			</field>
			<field name="effectiveTime" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="author" internal="parent02">
				<from>#{internalId( account, act.participation['author'].role.id)}</from>
			</field>
			<field name="encounter" internal="parent03">
				<from>#{internalId( account, act.relationship['encounter'].act.id)}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
			<field name="displayName">
				<from>#{act.observation.value.CE.displayName}</from>
			</field>
			<field name="codeSystem"  >	
				<from>#{act.observation.value.CE.codeSystem}</from>
			</field>
			<field name="codeSystemName"  >
				<from>#{act.observation.value.CE.codeSystemName}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="dxsum" visible="never">
			<column name="Date" internal="date01" format="MM/dd/yy">
				<from>#{diagnosis.effectiveTime}</from>
			</column>
			<column name="title" internal="string01">
				<from>#{diagnosis.title}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="dxsum" portalColumn="3" sequence="2" title="Diagnoses" page="/five/summaryPortletList.xhtml" query="echr:patient:summary:dxsum" visible="true" drilldown=":diagnoses">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:dxMenu" >
				<column name="Diagnosis" internal="string01" instantiate="true" width="40.0"/>
			</action>
		</portlet>  
	</extends>
	<extends path="echr:patient">
		<menu name="diagnoses" sequence="10" title="Diagnoses" page="/five/bar2.xhtml" visible="true">
			<list name="current" title="Current" page="/five/list.xhtml" visible="true" drilldown=":diagnosis">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="10.0">
					<from>#{diagnosis.effectiveTime}</from>
				</column>
				<column name="Diagnosis" internal="string01" reference="true" width="40.0">
					<from>#{diagnosis.title}</from>
				</column>
				<column name="Code" internal="string02" reference="true" width="15.0">
					<from>#{diagnosis.code}</from>
				</column>
				<column name="Source" internal="string03" width="15.0">
					<from>#{diagnosis.author.lastName}</from>
					<from>#{diagnosis.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="15.0">
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:dxMenu" >
					<column name="Diagnosis" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
			<trimList name="menu" title="New" page="/five/list.xhtml" visible="false" placeholder="global:diagnosisMenu" >
				<column name="Diagnosis" internal="string01" instantiate="true" width="40.0"/>
			</trimList>
			<trimList name="breastMenu" title="New" page="/five/list.xhtml" visible="false" placeholder="global:breastDiagnosisMenu" >
				<column name="Diagnosis" internal="string01" instantiate="true" width="40.0"/>
			</trimList>			
		</menu>
	</extends>
	<!-- Patient Observations -->
	<extends path="echr:patient">
		<placeholder name="observation" title="Observation" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/obsLink.xhtml">
			<field name="test" internal="string01" >
				<from>#{act.text.ST.value}</from>
				<from>#{act.title.ST.value}</from>
			</field>
			<field name="effectiveTime" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="value" internal="pqValue01">
				<from>#{act.observation.value.PQ.value}</from>
			</field>
			<field name="units" internal="pqUnits01">
				<from>#{act.observation.value.PQ.unit}</from>
			</field>
			<field name="value2" internal="pqValue02">
				<from>#{act.relationship['systolic'].act.observation.value.PQ.value}</from>
			</field>
			<field name="units2" internal="pqUnits02">
				<from>#{act.relationship['systolic'].act.observation.value.PQ.unit}</from>
			</field>
			<field name="value3" internal="pqValue03">
				<from>#{act.relationship['diastolic'].act.observation.value.PQ.value}</from>
			</field>
			<field name="units3" internal="pqUnits03">
				<from>#{act.relationship['diastolic'].act.observation.value.PQ.unit}</from>
			</field>
			<field name="code" internal="code01">
				<from>#{act.code.value}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="author" internal="parent02">
				<from>#{internalId( account, act.participation['author'].role.id)}</from>
			</field>
			<field name="encounter" internal="parent03">
				<from>#{internalId( account, act.relationship['encounter'].act.id)}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="obssum" visible="never">
			<column name="test" internal="string01" >
				<from>#{observation.test}</from>
			</column>
			<column name="effectiveTime" internal="date01">
				<from>#{observation.effectiveTime}</from>
			</column>
			<column name="value" internal="pqValue01">
				<from>#{observation.value}</from>
			</column>
			<column name="units" internal="pqUnits01">
				<from>#{observation.units}</from>
			</column>
			<column name="author" internal="parent02">
				<from>#{observation.author}</from>
			</column>
			<column name="encounter" internal="parent03">
				<from>#{observation.encounter}</from>
			</column>
			<column name="enteredBy" internal="string05">
				<from>#{observation.enteredBy}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="obssum" portalColumn="1" sequence="3" title="Observations" page="/five/obsSummary.xhtml" query="echr:patient:summary:obssum" visible="true" drilldown=":observations">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:observationMenu" >
				<column name="Observation" internal="string01" instantiate="true" width="40.0"/>
			</action>
		</portlet>  
	</extends>
	<extends path="echr:patient">
		<menu name="observations" sequence="12" title="Observations" page="/five/bar2.xhtml" visible="true">
			<list name="all" title="List" page="/five/list.xhtml" visible="true" drilldown=":observation">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="15.0">
					<from>#{observation.effectiveTime}</from>
				</column>
				<column name="Test" internal="string01" reference="true" width="20.0">
					<from>#{observation.test}</from>
				</column>
				<column name="Value" internal="pqValue01" width="6.0" align="right">
					<from>#{observation.value}</from>
				</column>
				<column name="Units" internal="pqUnits01" width="6.0">
					<from>#{observation.units}</from>
				</column>
				<column name="Source" internal="string02" width="20.0">
					<from>#{observation.author.lastName}</from>
					<from>#{observation.enteredBy}</from>
				</column>
				<column name="Encounter" internal="string04" width="21.0"/>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:observationMenu" >
					<column name="Observation" internal="string01" instantiate="true" width="40.0"/>
				</action>
				<action name="graph" title="Graph" page="/five/list.xhtml" visible="true" query="global:observationMenu">
					<menuEventHandler factory="org.tolven.graph.GraphMenuEventHandlerFactory">
						<data name="timeColumn" value="Date"/>
						<data name="valueColumn" value="Value"/>
						<data name="unitsColumn" value="Units"/>
						<data name="datasetColumn" value="Test"/>
						<data name="title" value="Observations"/>
						<data name="xAxisLabel" value="Date"/>
						<data name="yAxisLabel" value="Value"/>
					</menuEventHandler>
				</action>
			</list>
			<list name="graphs" title="Graphs" page="/five/list.xhtml" visible="false" drilldown=":graph">
				<column name="Date" internal="date01" format="MMM-dd-yyyy" width="10.0"/>
				<column name="Graph" internal="string01" reference="true" width="20.0"/>
				<column name="Source" internal="string02" width="25.0">
					<from>#{graph.author.lastName}</from>
					<from>#{graph.enteredBy}</from>
				</column>
			</list>
			<trimList name="graph" title="Graph" page="/five/list.xhtml" visible="true" placeholder="global:observationGraphMenu" >
				<column name="Graph" internal="string01" instantiate="true" width="40.0"/>
			</trimList>
		</menu>
	</extends>
	<!-- Patient reminders -->
	<extends path="echr:patient">
		<placeholder name="reminder" title="Reminder" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/reminderLink.xhtml">
			<field name="type" internal="string01" >
				<from>#{act.title.ST.value}</from>
			</field>
			<field name="effectiveTime" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="text" internal="string02" >
				<from>#{act.text.ST.value}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="remindersum" visible="never"/>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="remindersum" portalColumn="2" sequence="3" title="Reminders" page="/five/reminderSummary.xhtml" query="echr:patient:summary:remindersum" visible="false" drilldown=":reminders">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:reminderMenu" >
				<column name="Reminder" internal="string01" instantiate="true" width="40.0"/>
			</action>
		</portlet>  
	</extends>
	<extends path="echr:patient:summary:calendar">
		<entry name="reminder" sequence="4"  title="Reminder" query="echr:patient:summary:remindersum" visible="true" drilldown=":reminders"/>
	</extends>
	<extends path="echr:patient">
		<menu name="reminders" sequence="13" title="Reminders" page="/five/bar2.xhtml" visible="true">
			<list name="current" title="Current" page="/five/list.xhtml" visible="true" drilldown=":reminder">
				<column name="Date" internal="date01" format="MMM-dd-yyyy hh:mm" width="10.0"/>
				<column name="Reminder" internal="string01" reference="true" width="40.0"/>
				<column name="Source" internal="string02" width="25.0">
					<from>#{reminder.author.lastName}</from>
					<from>#{reminder.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:reminderMenu" >
					<column name="Reminder" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
		</menu>
	</extends>
	<!-- Patient Treatment Plans -->
	<extends path="echr:patient">
		<placeholder name="plan" title="Plan" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/treatmentLink.xhtml">
			<field name="effectiveTimeLow" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="effectiveTimeHigh" internal="date02">
				<from>#{act.effectiveTime.IVLTS.high.date}</from>
			</field>
			<field name="title" internal="string01" >
				<from>#{act.text.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="planStatus" internal="string02" >
				<from>#{act.relationship["planStatus"].act.observation.value.CE.displayName}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="author" internal="parent02">
				<from>#{internalId( account, act.participation['author'].role.id)}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="plansum" visible="never">
			<column name="FromDate" internal="date01" format="MM/dd/yy">
				<from>#{plan.effectiveTimeLow}</from>
			</column>
			<column name="title" internal="string01">
				<from>#{plan.title}</from>
			</column>
			<column name="author" internal="string02">
				<from>#{plan.author.lastName}</from>
			</column>
			<column name="planStatus" internal="string03">
				<from>#{plan.planStatus}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="plansum" portalColumn="2" sequence="5" title="Treatment Plans" page="/five/summaryPortletList.xhtml" query="echr:patient:summary:plansum" visible="true" drilldown=":plans">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:treatmentPlanMenu" >
				<column name="Plan" internal="string01" instantiate="true" width="30.0"/>
			</action>
		</portlet>  
	</extends>
	<extends path="echr:patient:summary">
		<list name="plan1sum" visible="never">
			<column name="title" internal="string01">
				<from>#{plan.title}</from>
				<from>#{procedure.title}</from>
			</column>
			<column name="author" internal="string02">
				<from>#{plan.author.lastName}</from>
			</column>
			<column name="FromDate" internal="date01">
				<from>#{plan.effectiveTimeLow}</from>
				<from>#{procedure.effectiveTimeLow}</from>
			</column>
			<column name="ToDate" internal="date02">
				<from>#{plan.effectiveTimeHigh}</from>
				<from>#{procedure.effectiveTimeHigh}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="plan1sum" sequence="6" title="Treatment Plan" query="echr:patient:summary:plan1sum" visible="true" interval="month" style="FFFFAD" drilldown=":plans">  
			<action name="menu" title="Action" page="/five/list.xhtml" visible="true" query="global:planActionMenu" >
				<column name="Action" internal="string01" instantiate="true" width="30.0"/>
			</action>
		</band>
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="plan2sum" sequence="7" title="Treatment Plan" query="echr:patient:summary:plan2sum" visible="true" interval="month" style="FFFFAD" drilldown=":plans">
			<action name="menu" title="Action" page="/five/list.xhtml" visible="true" query="global:planActionMenu" >
				<column name="Action" internal="string01" instantiate="true" width="30.0"/>
			</action>
		</band>  
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="plan3sum" sequence="8" title="Treatment Plan" query="echr:patient:summary:plan3sum" visible="true" interval="month" style="FFFFAD" drilldown=":plans">
			<action name="menu" title="Action" page="/five/list.xhtml" visible="true" query="global:planActionMenu" >
				<column name="Action" internal="string01" instantiate="true" width="30.0"/>
			</action>
		</band>  
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="plan4sum" sequence="9" title="Treatment Plan" query="echr:patient:summary:plan4sum" visible="true" interval="month" style="FFFFAD" drilldown=":plans">
			<action name="menu" title="Action" page="/five/list.xhtml" visible="true" query="global:planActionMenu" >
				<column name="Action" internal="string01" instantiate="true" width="30.0"/>
			</action>
		</band>  
	</extends>
	<extends path="echr:patient:summary">
		<list name="plan2sum" visible="never">
			<column name="title" internal="string01">
				<from>#{plan.title}</from>
				<from>#{procedure.title}</from>
			</column>
			<column name="author" internal="string02">
				<from>#{plan.author.lastName}</from>
			</column>
			<column name="FromDate" internal="date01">
				<from>#{plan.effectiveTimeLow}</from>
				<from>#{procedure.effectiveTimeLow}</from>
			</column>
			<column name="ToDate" internal="date02">
				<from>#{plan.effectiveTimeHigh}</from>
				<from>#{procedure.effectiveTimeHigh}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary">
		<list name="plan3sum" visible="never">
			<column name="title" internal="string01">
				<from>#{plan.title}</from>
				<from>#{procedure.title}</from>
			</column>
			<column name="author" internal="string02">
				<from>#{plan.author.lastName}</from>
			</column>
			<column name="FromDate" internal="date01">
				<from>#{plan.effectiveTimeLow}</from>
				<from>#{procedure.effectiveTimeLow}</from>
			</column>
			<column name="ToDate" internal="date02">
				<from>#{plan.effectiveTimeHigh}</from>
				<from>#{procedure.effectiveTimeHigh}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary">
		<list name="plan4sum" visible="never">
			<column name="title" internal="string01">
				<from>#{plan.title}</from>
				<from>#{procedure.title}</from>
			</column>
			<column name="author" internal="string02">
				<from>#{plan.author.lastName}</from>
			</column>
			<column name="FromDate" internal="date01">
				<from>#{plan.effectiveTimeLow}</from>
				<from>#{procedure.effectiveTimeLow}</from>
			</column>
			<column name="ToDate" internal="date02">
				<from>#{plan.effectiveTimeHigh}</from>
				<from>#{procedure.effectiveTimeHigh}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient">
		<menu name="plans" sequence="14" title="Plans" page="/five/bar2.xhtml" visible="true">
			<list name="all" title="All" page="/five/list.xhtml" visible="true" drilldown=":plan">
				<column name="Date" internal="date01" format="MMM-dd-yyyy hh:mm" width="15.0">
					<from>#{plan.effectiveTimeLow}</from>
				</column>
				<column name="Plan" internal="string02" reference="true" width="25.0">
					<from>#{plan.title}</from>
				</column>
				<column name="Status" internal="string04" width="8.0">
					<from>#{plan.planStatus}</from>
				</column>
				<column name="Source" internal="string03" width="15.0">
					<from>#{plan.author.lastName}</from>
					<from>#{plan.enteredBy}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:treatmentPlanMenu" >
					<column name="Plan" internal="string01" instantiate="true" width="30.0"/>
				</action>
			</list>
		</menu>
	</extends>
	<!-- Patient Procedures (px) -->
	<extends path="echr:patient">
	    <placeholder name="px" sequence="15" title="Procedure" eventInstance="echr:patient:wip" heading="/five/treatmentLink.xhtml" page="/wizard/wizard.xhtml">
	            <field internal="string01" name="title">
	                <from>#{act.code.CE.displayName}</from>
	                <from>#{trim.description}</from>
	            </field>
	            <field internal="date01" name="effectiveTimeLow">
	                <from>#{act.effectiveTime.TS.date}</from>
	                <from>#{act.effectiveTime.IVLTS.low.date}</from>
	            </field>
	            <field internal="date02" name="effectiveTimeHigh">
	                <from>#{act.effectiveTime.IVLTS.high.date}</from>
	            </field>
                <field internal="parent01" name="patient">
                    <from>#{patient}</from>
                </field>
	            <field internal="parent02" name="author">
	                <from>#{internalId( account, trim.act.participation['author'].role.id)}</from>
	            </field>
                <field internal="string05" name="enteredBy">
                    <from>#{internalId( account, trim.act.participation['dataEnterer'].role.id)}</from>
                </field>
        </placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="procsum" visible="never" >
			<column name="FromDate" internal="date01" format="MM/dd/yy">
				<from>#{procedure.effectiveTimeLow}</from>
				<from>#{px.effectiveTimeLow}</from>
			</column>
			<column name="title" internal="string01">
				<from>#{procedure.title}</from>
                   <from>#{px.title}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="procsum" portalColumn="3" sequence="3" title="Procedures" page="/five/summaryPortletList.xhtml" query="echr:patient:summary:procsum" visible="true" drilldown=":procedures">  
			<action title="New" name="menu" query="global:pxDocMenu" visible="true" page="/five/list.xhtml" >
				<column width="40.0" instantiate="true" internal="string01" name="Procedure"/>
			</action>                
		</portlet>
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="procsum" sequence="3" title="Procedures" query="echr:patient:summary:procsum" visible="true" interval="month" style="E0E0E0" drilldown=":procedures"/>  
	</extends>
	<extends path="echr:patient:summary:calendar">
		<entry name="procedure" sequence="5"  title="Procedure" query="echr:patient:summary:procsum" visible="true" drilldown=":procedures"/>
	</extends>
	<extends path="echr:patient">
		<menu name="procedures" sequence="19" title="Procedures" page="/five/bar2.xhtml" visible="true">
            <list name="pxList" title="Current" drilldown=":px" visible="true" page="/five/list.xhtml">
                <column width="10.0" format="MMM-dd-yyyy" internal="date01" name="Date">
                    <from>#{px.effectiveTimeLow}</from>
                </column>
                <column width="40.0" reference="true" internal="string01" name="Procedure">
                    <from>#{px.title}</from>
                </column>
                <column width="15.0" internal="string03" name="Performer">
                    <from>#{px.author.lastName}</from>
                    <from>#{px.enteredBy}</from>
                </column>
                <action title="New" name="menu" query="global:pxDocMenu" visible="true" page="/five/list.xhtml" >
                    <column width="40.0" instantiate="true" internal="string01" name="Procedure"/>
                </action>                
            </list>
		</menu>
	</extends>
	<!-- Patient Personal Events -->
	<extends path="echr:patient">
		<placeholder name="personalEvent" title="Personal Event" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/personalEventLink.xhtml">
			<field name="effectiveTimeLow" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
				<from>#{act.effectiveTime.IVLTS.low.date}</from>
			</field>
			<field name="effectiveTimeHigh" internal="date02">
				<from>#{act.effectiveTime.IVLTS.high.date}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="event" internal="string01" >
				<from>#{act.text.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
			<field name="enteredBy" internal="string05">
				<from>#{internalId( account, act.participation['dataEnterer'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient:summary">
		<list name="pevnsum" visible="never">
			<column name="dateFrom" internal="date01" format="MM/dd/yy">
				<from>#{personalEvent.effectiveTimeLow}</from>
			</column>
			<column name="dateTo" internal="date02" format="MM/dd/yy">
				<from>#{personalEvent.effectiveTimeHigh}</from>
			</column>
			<column name="event" internal="string01">
				<from>#{personalEvent.event}</from>
			</column>
		</list>
	</extends>
	<extends path="echr:patient:summary:portal">
		<portlet name="pevnsum" portalColumn="3" sequence="4" title="Personal Events" page="/five/summaryPortletList.xhtml" query="echr:patient:summary:pevnsum" visible="true" drilldown=":personalEvents">  
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:appointmentMenu" >
				<column name="Appointment" internal="string01" instantiate="true" width="30.0"/>
			</action>
		</portlet>  
	</extends>
	<extends path="echr:patient:summary:timeline">
		<band name="pevnsum" sequence="5" title="Personal Events" query="echr:patient:summary:pevnsum" visible="true" interval="month" style="FFFFAD" drilldown=":personalEvents">
			<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:appointmentMenu" >
				<column name="Appointment" internal="string01" instantiate="true" width="30.0"/>
			</action>
		</band>  
	</extends>
	<extends path="echr:patient:summary:calendar">
		<entry name="pevnsum" sequence="6" title="Personal Event" query="echr:patient:summary:pevnsum" visible="true" drilldown=":personalEvents"/>  
	</extends>
	<extends path="echr:patient">
		<menu name="personalEvents" sequence="19" title="Personal Events" page="/five/bar2.xhtml" visible="true">
			<list name="all" title="All" page="/five/list.xhtml" visible="true" drilldown=":personalEvent">
				<column name="From" internal="date01" format="MMM-dd-yyyy hh:mm" width="10.0">
					<from>#{personalEvent.effectiveTimeLow}</from>
				</column>
				<column name="To" internal="date02" format="MMM-dd-yyyy hh:mm" width="10.0">
					<from>#{personalEvent.effectiveTimeHigh}</from>
				</column>
				<column name="Event" internal="string01" reference="true" width="40.0">
						<from>#{personalEvent.event}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:appointmentMenu">
					<column name="Event" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
		</menu>
	</extends>
	<!-- Trial forms for a patient -->
	<extends path="echr:patient">
		<placeholder name="trialForm" title="TrialForm" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/wipLink.xhtml">
			<field name="effectiveTime" internal="date01">
				<from>#{act.effectiveTime.TS.date}</from>
			</field>
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="title" internal="string01" >
				<from>#{act.text.ST.value}</from>
				<from>#{trim.description}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient">
		<menu name="trialForms" sequence="25" title="Trial Forms" page="/five/bar2.xhtml" visible="true">
			<list name="all" title="All" page="/five/list.xhtml" visible="true" drilldown=":trialForm">
				<column name="Effective" internal="date01" format="MMM-dd-yyyy" width="10.0">
					<from>#{trialForm.effectiveTime}</from>
				</column>
				<column name="Title" internal="string01" reference="true" width="40.0">
						<from>#{trialForm.title}</from>
				</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:trialFormMenu">
					<column name="Event" internal="string01" instantiate="true" width="40.0"/>
				</action>
			</list>
		</menu>
	</extends>
	<!-- Patient's providers -->
	<extends path="echr:patient">
		<placeholder name="patprovider" title="Provider" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/wipLink.xhtml">
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
			<field name="provider" internal="parent02">
				<from>#{internalId( account, act.participation['responsibleParty'].role.id)}</from>
			</field>
		</placeholder>
	</extends>
	<extends path="echr:patient">
		<menu name="personal"  sequence="3" title="Personal" page="/five/bar2.xhtml" visible="true">
			<list name="identity" title="Identity" page="/five/personal.xhtml" visible="true" drilldown="echr:patient"/>
			<list name="providers" title="Providers" page="/five/list.xhtml" visible="true" drilldown=":patprovider">
				<column name="Provider" internal="string01" width="40.0">
					<from>#{patprovider.provider.lastName}</from>
				</column>
			</list>
		</menu>
	</extends>
	<!-- Patient Docuemnts -->
	<extends path="echr:patient">
		<placeholder name="patDoc" title="Document" page="/wizard/wizard.xhtml" heading="/five/documentLink.xhtml">
			<field name="effectiveTime" internal="date01" >
				<from>#{trim.act.effectiveTime.TS.date}</from>
			</field>
			<field name="title" internal="string01">
				<from>#{trim.description}</from>
			</field>
			<field name="source" internal="string05" >
			</field>
		</placeholder>	
	</extends>
	<extends path="echr:patient">
		<menu name="documents" sequence="21" title="Document" page="/five/bar2.xhtml" visible="true">
			<list name="all" title="All Documents" page="/five/list.xhtml" visible="true" drilldown=":patDoc">
				<column name="Date" internal="date01" format="MMM-dd-yyyy hh:mm" width="10.0">
					<from>#{patDoc.effectiveTime}</from>
				</column>
				<column name="Name" internal="string01" width="25.0" reference="true">
					<from>#{patDoc.title}</from>
				</column>
				<column name="Source" internal="string02" width="45.0" >
					<from>#{patDoc.source}</from>
				</column>				
			</list>
		</menu>
	</extends>
	<extends path="echr:patient">
		<menu name="reports" title="Reports" page="/five/bar2.xhtml" visible="true">
			<list name="list" title="List" page="/five/patientReports.xhtml" visible="true" drilldown="echr:patient"/>
		</menu>
	</extends>
	<extends path="echr:patient">
		<instance name="wip" title="New Patient Event" page="/wizard/wizard.xhtml" heading="/five/wipLink.xhtml"/>
	</extends>
	<extends path="echr:patient">
		<placeholder name="graph" title="Graph" eventInstance="echr:patient:wip" page="/wizard/wizard.xhtml" heading="/five/graphLink.xhtml">
			<field name="patient" internal="parent01">
				<from>#{patient}</from>
			</field>
		</placeholder>
	</extends>
	<!-- Patient lists -->
	<extends path="echr">
		<menu name="patients" sequence="30" title="Patients" page="/five/patients.xhtml" visible="true">
			<list name="all" title="My Patients" page="/five/patientList.xhtml" visible="true" drilldown="echr:patient">
				<column name="Name" internal="string01,string02,string03" format="%s, %s %s" reference="true" width="20.0"/>
				<column name="Last" internal="string01" visible="false">
					<from>#{patient.lastName}</from>
				</column>
				<column name="First" internal="string02" visible="false">
					<from>#{patient.firstName}</from>
				</column>
				<column name="Middle" internal="string03" visible="false">
					<from>#{patient.middleName}</from>
				</column>
				<column name="DOB" internal="date01" format="d MMM yyyy" width="7.0">
					<from>#{patient.dob}</from>
				</column>
				<column name="Age" internal="date01" format="age" width="4.5"/>
				<column name="Sex" internal="string04" width="6.0">
					<from>#{patient.sex}</from>
					<from>#{patient.gender}</from>
					<output><span style="color:#{ Sex=='Female'?'HotPink':'Blue'}" 
					title="#{ageInYears(date01) lt 21?'child':'adult'}">#{Sex}</span></output>
				</column>
				<column name="Phone" width="10.0" internal="string06" visible="true">
					<from>#{patient.homeTelecom}</from>
					<output><a href="javascript:alert('Primary: #{patient.primary.firstName} #{patient.primary.lastName} #{patient.primary.workTelecom}');">#{Phone}</a></output>
				</column>
			    <column name="MRN" width="10.0" internal="string05" visible="true">
     				<from>#{patient.mrn}</from>
					<output><span title="Patient id: #{patient.id}">#{MRN}</span></output>
    			</column>
			    <column name="Race" width="10.0" visible="false">
     				<from>#{patient.race}</from>
    			</column>
				<action name="menu" title="New" page="/five/list.xhtml" visible="true" query="global:patientMenu" >
					<column name="Action" internal="string01" instantiate="true" width="25.0"/>
				</action>
			</list>
			<list name="in" title="Inpatients" page="/five/list.xhtml" visible="true" drilldown="echr:patient">
				<column name="Name" internal="string01,string02" format="%s, %s" reference="true" width="20.0"/>
				<column name="Last" internal="string01" visible="false">
					<from>#{patient.lastName}</from>
				</column>
				<column name="First" internal="string02" visible="false">
					<from>#{patient.firstName}</from>
				</column>
				<column name="Problem" internal="string03" visible="false"/>
				<column name="DOB" internal="date01" format="d MMM yyyy" width="7.0">
					<from>#{patient.dob}</from>
				</column>
				<column name="Age" internal="date01" format="age" width="4.5"/>
				<column name="Sex" internal="string04" width="6.0">
					<from>#{patient.sex}</from>
				</column>
				<column name="Location" internal="string05" width="10.0">
					<from>#{encounter.location.name}</from>
					<from>#{encounter.otherLocation}</from>					
				</column>
				<column name="Attending" internal="string06" width="20.0">
					<from>#{encounter.attender.lastName}, #{encounter.attender.firstName}</from>
				</column>
			</list>
			<list name="dm" title="Diabetes Registry" page="/five/list.xhtml" visible="true" drilldown="echr:patient">
				<column name="Name" internal="string01,string02" format="%s, %s" reference="true" width="20.0"/>
				<column name="Last" internal="string01" visible="false">
					<from>#{patient.lastName}</from>
				</column>
				<column name="First" internal="string02" visible="false">
					<from>#{patient.firstName}</from>
				</column>
				<column name="Problem" internal="string03" visible="false"/>
				<column name="DOB" internal="date01" visible="false">
					<from>#{patient.dob}</from>
				</column>
				<column name="Age" internal="date01" format="age" width="4.5"/>
				<column name="Sex" internal="string04" width="6.0">
					<from>#{patient.sex}</from>
					<from>#{patient.gender}</from>
				</column>
				<column name="Onset" internal="date02" format="yyyy" width="7.0"/>
			</list>
			<list name="asthma" title="Asthma Registry" page="/five/list.xhtml" visible="true" drilldown="echr:patient">
				<column name="Name" internal="string01,string02" format="%s, %s" reference="true" width="20.0"/>
				<column name="Last" internal="string01" visible="false">
					<from>#{patient.lastName}</from>
				</column>
				<column name="First" internal="string02" visible="false">
					<from>#{patient.firstName}</from>
				</column>
				<column name="Problem" internal="string03" visible="false"/>
				<column name="DOB" internal="date01" visible="false">
					<from>#{patient.dob}</from>
				</column>
				<column name="Age" internal="date01" format="age" width="4.5"/>
				<column name="Sex" internal="string04" width="6.0">
					<from>#{patient.sex}</from>
					<from>#{patient.gender}</from>
				</column>
				<column name="Onset" internal="date02" format="yyyy" width="7.0"/>
			</list>
			<list name="htn" title="Hypertension Registry" page="/five/list.xhtml" visible="true" drilldown="echr:patient">
				<column name="Name" internal="string01,string02" format="%s, %s" reference="true" width="20.0"/>
				<column name="Last" internal="string01" visible="false">
					<from>#{patient.lastName}</from>
				</column>
				<column name="First" internal="string02" visible="false">
					<from>#{patient.firstName}</from>
				</column>
				<column name="Problem" internal="string03" visible="false"/>
				<column name="DOB" internal="date01" visible="false">
					<from>#{patient.dob}</from>
				</column>
				<column name="Age" internal="date01" format="age" width="4.5"/>
				<column name="Sex" internal="string04" width="6.0">
					<from>#{patient.sex}</from>
					<from>#{patient.gender}</from>
				</column>
				<column name="Onset" internal="date02" format="yyyy" width="7.0"/>
			</list>
			<list name="vip" title="VIP" page="/five/list.xhtml" visible="true" drilldown="echr:patient">
				<column name="Name" internal="string01,string02" format="%s, %s" reference="true" width="20.0"/>
				<column name="Last" internal="string01" visible="false">
					<from>#{patient.lastName}</from>
				</column>
				<column name="First" internal="string02" visible="false">
					<from>#{patient.firstName}</from>
				</column>
				<column name="Middle" internal="string03" visible="false">
					<from>#{patient.middleName}</from>
				</column>
				<column name="DOB" internal="date01" visible="false">
					<from>#{patient.dob}</from>
				</column>
				<column name="Age" internal="date01" format="age" width="4.5"/>
				<column name="Sex" internal="string04" width="6.0">
					<from>#{patient.sex}</from>
					<from>#{patient.gender}</from>
				</column>
			</list>
			<list name="mammo" title="Mammogram" page="/five/list.xhtml" visible="true" drilldown="echr:patient">
				<column name="Name" internal="string01,string02" format="%s, %s" reference="true" width="20.0"/>
				<column name="Last" internal="string01" visible="false">
					<from>#{patient.lastName}</from>
				</column>
				<column name="First" internal="string02" visible="false">
					<from>#{patient.firstName}</from>
				</column>
				<column name="Problem" internal="string03" visible="false"/>
				<column name="DOB" internal="date01" visible="false">
					<from>#{patient.dob}</from>
				</column>
				<column name="Age" internal="date01" format="age" width="4.5"/>
				<column name="Sex" internal="string04" width="6.0">
					<from>#{patient.sex}</from>
					<from>#{patient.gender}</from>
				</column>
				<column name="LastMammo" internal="date02" format="MM-yyyy" width="7.0"/>
			</list>
			<list name="terminated" title="Terminated" page="/five/patientList.xhtml" visible="true" drilldown="echr:patient">
				<column name="Name" internal="string01,string02,string03" format="%s, %s %s" reference="true" width="20.0"/>
				<column name="Last" internal="string01" visible="false">
					<from>#{patient.lastName}</from>
				</column>
				<column name="First" internal="string02" visible="false">
					<from>#{patient.firstName}</from>
				</column>
				<column name="Middle" internal="string03" visible="false">
					<from>#{patient.middleName}</from>
				</column>
				<column name="DOB" internal="date01" format="d MMM yyyy" width="7.0">
					<from>#{patient.dob}</from>
				</column>
				<column name="Age" internal="date01" format="age" width="4.5"/>
				<column name="Sex" internal="string04" width="6.0">
					<from>#{patient.sex}</from>
					<from>#{patient.gender}</from>
				</column>
				<column name="Phone" width="10.0" internal="string06" visible="true">
					<from>#{patient.homeTelecom}</from>
				</column>
			    <column name="MRN" width="10.0" internal="string05" visible="true">
     				<from>#{patient.mrn}</from>
    			</column>
			</list>
			<instance name="wip" title="WIP" page="/wizard/wizard.xhtml" heading="/five/chartLink.xhtml"/>
		</menu>
	</extends>
	<extends path="echr:provider">
		<menu name="patients" title="Patients" page="/five/bar2.xhtml" visible="true">
			<list name="all" title="All" page="/five/list.xhtml" visible="true" drilldown="echr:patient">
				<column name="Name" internal="string01,string02,string03" format="%s, %s %s" reference="true" width="20.0"/>
				<column name="DOB" internal="date01" format="d MMM yyyy" width="7.0"/>
				<column name="Sex" internal="string04" width="6.0"/>
				<column name="Status" internal="string05" width="6.0"/>
			</list>
		</menu>
	</extends>

</application>
